<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gifts Royale ‚Äî –ö–µ–π—Å—ã</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <meta name="color-scheme" content="light dark" />
  <style>
    :root{
      --bg:#0b0f17;--panel:#101522;--card:#151b2b;--card2:#111727;
      --text:#e7ecf6;--muted:#97a3be;--border:rgba(255,255,255,.06);
      --chip:#0f1524;--chip-active:#1a2236;
      --accent:#57d2a3;--brand:#58a6ff;
      --gold:#f7ce6a;--gold2:#e3b84d;
      --danger:#ff6a6a;--ok:#a9ffdd;--shadow:0 10px 28px rgba(0,0,0,.35)
    }
    .tg-light{
      --bg:#f4f7fb;--panel:#ffffff;--card:#ffffff;--card2:#f7f9fc;
      --text:#121620;--muted:#55617b;--border:rgba(0,0,0,.08);
      --chip:#eef2f8;--chip-active:#e3e9f5;--shadow:0 10px 24px rgba(0,0,0,.10)
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
    body{background:radial-gradient(1200px 800px at -10% -10%, rgba(88,166,255,.10), transparent),linear-gradient(180deg,var(--bg),#070b12); color:var(--text)}
    .app{min-height:100%;display:flex;flex-direction:column}

    /* top bar */
    .topbar{display:flex;align-items:center;gap:10px;padding:10px 14px;position:sticky;top:0;z-index:10;background:var(--panel);border-bottom:1px solid var(--border)}
    .avatar{width:34px;height:34px;border-radius:10px;display:grid;place-items:center;background:linear-gradient(135deg,rgba(88,166,255,.25),rgba(87,210,163,.25));border:1px solid var(--border);font-weight:700}
    .title{font-weight:800;letter-spacing:.2px}
    .grow{flex:1}
    .pill{display:flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:linear-gradient(180deg,#0e1524,#0c1320);border:1px solid var(--border);font-weight:700;font-size:13px}
    .pill .num{min-width:24px;text-align:right}
    .theme-btn{margin-left:8px;border:1px solid var(--border);background:var(--chip);border-radius:999px;padding:6px 10px;cursor:pointer}

    /* chips */
    .chipbar{display:flex;gap:8px;padding:10px 14px;overflow-x:auto;background:var(--panel);border-bottom:1px solid var(--border)}
    .chip{white-space:nowrap;padding:8px 12px;border-radius:999px;background:var(--chip);border:1px solid var(--border);color:var(--muted);font-weight:700;cursor:pointer}
    .chip.active{background:var(--chip-active);color:var(--text);border-color:rgba(87,210,163,.35)}

    .content{flex:1;padding:14px;max-width:1100px;margin:0 auto;width:100%}
    h2.section{margin:10px 2px 8px;font-size:13px;color:var(--muted);letter-spacing:.8px}

    /* grid */
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    @media (min-width:520px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media (min-width:900px){.grid{grid-template-columns:repeat(4,1fr)}}

    .card{background:linear-gradient(180deg,var(--card),var(--card2));border:1px solid var(--border);border-radius:16px;padding:10px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:8px;position:relative;overflow:hidden;cursor:pointer}
    .thumb{height:120px;border-radius:12px;border:1px solid var(--border);background:#0d1321 center/cover no-repeat;position:relative;display:grid;place-items:center}
    .thumb.placeholder{background:#0d1321 url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22200%22 height=%22120%22><defs><linearGradient id=%22g%22 x1=%220%22 y1=%220%22 x2=%221%22 y2=%221%22><stop offset=%220%25%22 stop-color=%22%2358a6ff%22/><stop offset=%22100%25%22 stop-color=%22%2357d2a3%22/></linearGradient></defs><rect width=%22200%22 height=%22120%22 fill=%22%23101626%22/><g opacity=%220.22%22><circle cx=%2250%25%22 cy=%2250%25%22 r=%2240%22 fill=%22url(%23g)%22/></g><g font-family=%22Segoe UI%22 font-size=%2220%22 fill=%22%23b8c7e8%22 text-anchor=%22middle%22><text x=%2250%25%22 y=%2255%25%22>GIFTS</text></g></svg>') no-repeat}
    .underlight{position:absolute;left:12px;right:12px;bottom:8px;height:8px;border-radius:20px;background:radial-gradient(60% 100% at 50% 50%, rgba(87,210,163,.65), transparent)}
    .name{font-weight:800}
    .desc{font-size:12px;color:var(--muted);line-height:1.35}
    .price{font-weight:900;color:var(--brand)}
    .actions{display:flex;gap:8px}
    .btn{flex:1;display:flex;align-items:center;justify-content:center;gap:6px;padding:10px;border-radius:12px;border:1px solid rgba(87,210,163,.35);background:linear-gradient(180deg,var(--accent),#49c79c);color:#04151c;font-weight:900;cursor:pointer;transition:transform .06s ease}
    .btn:active{transform:translateY(1px)}
    .tabbar{position:sticky;bottom:0;background:var(--panel);border-top:1px solid var(--border);display:grid;grid-template-columns:repeat(5,1fr);padding:6px 4px;z-index:10}
    .tab{display:flex;flex-direction:column;align-items:center;gap:4px;padding:6px 2px;border-radius:12px;color:var(--muted);font-size:11px;font-weight:700}
    .tab.active{color:var(--text);background:var(--chip)}
    .tab .ico{font-size:18px}

    /* MODAL (–¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞) */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
    .modal.open{display:flex}
    .sheet{width:100%;max-width:480px;background:linear-gradient(180deg,var(--card),var(--card2));border:1px solid var(--border);border-radius:20px;padding:16px;box-shadow:var(--shadow);position:relative}
    .sheet .close{position:absolute;top:10px;right:10px;border:1px solid var(--border);background:var(--chip);color:var(--text);border-radius:10px;padding:6px 10px;cursor:pointer}
    .big-thumb{height:220px;border-radius:14px;border:1px solid var(--border);background:#0d1321 center/cover no-repeat;position:relative;margin-bottom:10px}
    .price-row{display:flex;align-items:center;justify-content:space-between;margin:6px 2px 12px}
    .price-tag{font-weight:900;color:var(--brand)}
    .gold{width:100%;padding:14px;border-radius:14px;border:1px solid #e2c15c;background:linear-gradient(180deg,var(--gold),var(--gold2));color:#2a1c00;font-weight:900;cursor:pointer}
    .ghost{width:100%;padding:12px;border-radius:12px;border:1px dashed var(--border);background:rgba(255,255,255,.08);color:var(--muted);font-weight:800;margin-top:8px;cursor:pointer}

    /* –º–∏–Ω–∏-–¥–∏–∞–ª–æ–≥ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è */
    .dialog{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);background:linear-gradient(180deg,var(--card),var(--card2));border:1px solid var(--border);border-radius:16px;padding:14px;width:92%;max-width:360px;display:none;z-index:60;box-shadow:var(--shadow)}
    .dialog.open{display:block}
    .dialog h3{margin:0 0 8px}
    .paylist{display:flex;flex-direction:column;gap:8px}
    .paybtn{padding:10px;border-radius:12px;background:var(--chip);border:1px solid var(--border);cursor:pointer;font-weight:800}
    .paybtn:active{transform:translateY(1px)}
  </style>
</head>
<body>
  <div class="app" id="app">
    <!-- Top bar -->
    <div class="topbar">
      <div class="avatar">GS</div>
      <div class="title">Gifts Royale</div>
      <div class="grow"></div>
      <div class="pill" title="–ë–∞–ª–∞–Ω—Å –∑–≤—ë–∑–¥"><span>‚≠ê</span><span class="num" id="stars">120</span></div>
      <button class="theme-btn" id="themeBtn" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</button>
    </div>

    <!-- –ß–∏–ø—ã -->
    <div class="chipbar" id="chips">
      <div class="chip active" data-filter="all">–í—Å–µ</div>
      <div class="chip" data-filter="free">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ</div>
      <div class="chip" data-filter="limit">–õ–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</div>
      <div class="chip" data-filter="popular">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</div>
    </div>

    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="content">
      <h2 class="section" id="sectionTitle">–ë–ï–°–ü–õ–ê–¢–ù–´–ï –ö–ï–ô–°–´</h2>
      <div class="grid" id="grid"></div>
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="tabbar">
      <div class="tab"><div class="ico">üèÜ</div>–ö–æ–Ω–∫—É—Ä—Å—ã</div>
      <div class="tab"><div class="ico">‚ö°</div>–ê–ø–≥—Ä–µ–π–¥</div>
      <div class="tab active"><div class="ico">üéÅ</div>–ö–µ–π—Å—ã</div>
      <div class="tab"><div class="ico">üë•</div>–î—Ä—É–∑—å—è</div>
      <div class="tab"><div class="ico">üë§</div>–ü—Ä–æ—Ñ–∏–ª—å</div>
    </nav>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –¥–µ—Ç–∞–ª–∏ –∫–µ–π—Å–∞ -->
  <div class="modal" id="modal">
    <div class="sheet">
      <button class="close" id="closeModal">‚úñ</button>
      <div class="big-thumb" id="bigThumb"></div>
      <div class="price-row">
        <div><b id="modalName">–ö–µ–π—Å</b></div>
        <div class="price-tag" id="modalPrice">500 ‚≠ê</div>
      </div>
      <button class="gold" id="spinBtn">–ö–†–£–¢–ò–¢–¨</button>
      <button class="ghost" id="demoBtn">–î–µ–º–æ –†–µ–∂–∏–º</button>
    </div>
  </div>

  <!-- –î–∏–∞–ª–æ–≥ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è -->
  <div class="dialog" id="topupDlg">
    <h3>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥</h3>
    <p style="margin:6px 0 10px;color:var(--muted)">–ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –æ–¥–Ω–∏–º –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤:</p>
    <div class="paylist">
      <button class="paybtn">1. –°–ë–ü</button>
      <button class="paybtn">2. –ó–≤—ë–∑–¥—ã Telegram</button>
      <button class="paybtn">3. –ö—Ä–∏–ø—Ç–∞ USDT/TRC20</button>
      <button class="paybtn" id="closeTopup">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <script>
    // ==== Telegram WebApp & —Ç–µ–º–∞ ====
    const tg = window.Telegram?.WebApp;
    tg?.ready?.();
    const isLight = (tg?.colorScheme || '').toLowerCase() === 'light';
    if (isLight) document.body.classList.add('tg-light');

    const themeBtn = document.getElementById('themeBtn');
    themeBtn.onclick = () => {
      document.body.classList.toggle('tg-light');
      themeBtn.textContent = document.body.classList.contains('tg-light') ? '‚òÄÔ∏è' : 'üåô';
    };

    // ==== –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–æ–≤ ====
    // –û–¥–∏–Ω —Ä–µ–∞–ª—å–Ω—ã–π –∫–µ–π—Å —Å —Ç–≤–æ–µ–π –∫–∞—Ä—Ç–∏–Ω–∫–æ–π –∏ —Ü–µ–Ω–æ–π 500 ‚≠ê
    const CASES = [
      { id:'pink', title:'Pink Royale', price:500, tag:'popular', img:'case-pink.png' }, // <‚Äî —Ç–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
      { id:'free1', title:'–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∑–∞ –ø—Ä–æ–º–æ–∫–æ–¥', price:0, tag:'free', img:null },
      { id:'limit1', title:'–•—ç–ª–ª–æ—É–∏–Ω (–ª–∏–º–∏—Ç.)', price:49, tag:'limit', img:null },
      { id:'starter', title:'–°—Ç–∞—Ä—Ç–æ–≤—ã–π', price:19, tag:'popular', img:null },
      { id:'daily', title:'–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π', price:0, tag:'free', img:null },
    ];

    // ==== –†–µ–Ω–¥–µ—Ä —Å–µ—Ç–∫–∏ ====
    const grid = document.getElementById('grid');
    function cardHTML(c){
      const isPlaceholder = !c.img;
      const thumbStyle = isPlaceholder
        ? 'thumb placeholder'
        : 'thumb';
      const bg = isPlaceholder ? '' : `style="background-image:url('${c.img}')"`;
      const subtitle = c.price === 0 ? '–ë–ï–°–ü–õ–ê–¢–ù–û' : `${c.price} ‚≠ê`;
      return `
        <div class="card" data-id="${c.id}">
          <div class="${thumbStyle}" ${bg}><div class="underlight"></div></div>
          <div class="name">${c.title}</div>
          <div class="desc">${c.price===0 ? '–û—Ç–∫—Ä—ã–≤–∞–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ –∏ –∑–∞–±–∏—Ä–∞–π –ø—Ä–∏–∑—ã' : '–®–∞–Ω—Å –Ω–∞ —Ä–µ–¥–∫–∏–µ –Ω–∞–≥—Ä–∞–¥—ã'}</div>
          <div class="price">${subtitle}</div>
        </div>
      `;
    }
    function render(filter='free'){
      document.getElementById('sectionTitle').textContent =
        filter==='all' ? '–í–°–ï –ö–ï–ô–°–´' :
        filter==='free' ? '–ë–ï–°–ü–õ–ê–¢–ù–´–ï –ö–ï–ô–°–´' :
        filter==='limit' ? '–õ–ò–ú–ò–¢–ò–†–û–í–ê–ù–ù–´–ï' : '–ü–û–ü–£–õ–Ø–†–ù–û–ï';
      grid.innerHTML = CASES.filter(c => filter==='all' ? true : c.tag===filter).map(cardHTML).join('');
    }
    render('free');

    // ==== –§–∏–ª—å—Ç—Ä—ã ====
    const chips = document.getElementById('chips');
    chips.addEventListener('click', (e)=>{
      const chip = e.target.closest('.chip'); if(!chip) return;
      chips.querySelectorAll('.chip').forEach(x=>x.classList.remove('active'));
      chip.classList.add('active');
      render(chip.dataset.filter);
    });

    // ==== –ë–∞–ª–∞–Ω—Å –∏ –º–æ–¥–∞–ª–∫–∞ ====
    let stars = Number(document.getElementById('stars').textContent) || 0;
    const modal = document.getElementById('modal');
    const bigThumb = document.getElementById('bigThumb');
    const modalName = document.getElementById('modalName');
    const modalPrice = document.getElementById('modalPrice');
    const spinBtn = document.getElementById('spinBtn');
    const demoBtn = document.getElementById('demoBtn');
    const topupDlg = document.getElementById('topupDlg');

    let currentCase = null;

    grid.addEventListener('click', (e)=>{
      const card = e.target.closest('.card'); if(!card) return;
      const id = card.dataset.id;
      currentCase = CASES.find(c => c.id === id);
      // –∑–∞–ø–æ–ª–Ω–∏—Ç—å –º–æ–¥–∞–ª–∫—É
      bigThumb.style.backgroundImage = currentCase.img ? `url('${currentCase.img}')` : '';
      bigThumb.classList.toggle('placeholder', !currentCase.img);
      modalName.textContent = currentCase.title;
      modalPrice.textContent = (currentCase.price || 0) === 0 ? '–ë–ï–°–ü–õ–ê–¢–ù–û' : `${currentCase.price} ‚≠ê`;
      modal.classList.add('open');
    });

    document.getElementById('closeModal').onclick = ()=> modal.classList.remove('open');

    // –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ "–ö–†–£–¢–ò–¢–¨"
    spinBtn.onclick = ()=>{
      if(!currentCase) return;
      const cost = currentCase.price || 0;
      if (cost > stars) {
        // –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
        topupDlg.classList.add('open');
        return;
      }
      // —Å–ø–∏—Å—ã–≤–∞–µ–º –∏ "–∫—Ä—É—Ç–∏–º"
      stars -= cost;
      document.getElementById('stars').textContent = stars;
      try{ tg?.sendData?.(JSON.stringify({type:'spin', caseId: currentCase.id, price: cost})) }catch(e){}
      try{ tg?.showPopup?.({title:'–ö–µ–π—Å –∫—Ä—É—Ç–∏—Ç—Å—è‚Ä¶', message:`–°–ø–∏—Å–∞–Ω–æ ${cost} ‚≠ê. –£–¥–∞—á–∏!`, buttons:[{type:'ok'}]}); }catch(e){}
      // —Ç—É—Ç –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é/—Ä–µ–∑—É–ª—å—Ç–∞—Ç
    };

    // –¥–µ–º–æ
    demoBtn.onclick = ()=>{
      try{ tg?.showAlert?.('–î–µ–º–æ-—Ä–µ–∂–∏–º: –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –±–µ–∑ —Å–ø–∏—Å–∞–Ω–∏—è –∑–≤—ë–∑–¥. (–ó–∞–≥–ª—É—à–∫–∞)'); }catch(e){ alert('–î–µ–º–æ-—Ä–µ–∂–∏–º (–∑–∞–≥–ª—É—à–∫–∞)'); }
    };

    // –æ–∫–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
    document.getElementById('closeTopup').onclick = ()=> topupDlg.classList.remove('open');
    topupDlg.addEventListener('click', (e)=>{
      if (e.target.classList.contains('paybtn')) {
        // –ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∏
        try{ tg?.showAlert?.('–ú–µ—Ç–æ–¥ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –µ—â—ë –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ.'); }catch(err){ alert('–ú–µ—Ç–æ–¥ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –µ—â—ë –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ.'); }
      }
    });
  </script>
</body>
</html>
