<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ò—Å–ø—ã—Ç–∞–π —É–¥–∞—á—É</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{--bg:#0f1220;--card:#171a2a;--text:#ffffff;--muted:#b9c0d0;--accent:#57d2a3}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:system-ui,Segoe UI,Roboto,Arial}
    .wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{width:100%;max-width:420px;background:var(--card);border-radius:20px;padding:22px;box-shadow:0 8px 30px rgba(0,0,0,.35)}
    h1{margin:0 0 6px;font-size:24px}
    p{margin:10px 0;color:var(--muted);line-height:1.5}
    .case{margin:18px 0 10px;height:170px;border:2px dashed #36405f;border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:18px;color:#9fb0d6}
    .btn{width:100%;padding:14px 16px;border:0;border-radius:14px;font-weight:700;font-size:16px;cursor:pointer;background:var(--accent);color:#0b1320;transition:transform .04s}
    .btn:active{transform:scale(.99)}
    .row{display:flex;gap:10px;margin-top:10px}
    .row .btn{flex:1}
    .result{margin-top:10px;padding:12px;border-radius:12px;background:#101526;color:#a9ffdd;display:none}
    .hint{font-size:12px;color:#7b86a7;margin-top:8px}
    .spin{animation:spin 1s linear infinite}
    @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>üéÅ –ò—Å–ø—ã—Ç–∞–π —É–¥–∞—á—É</h1>
      <p>–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ ‚Äî –æ—Ç–∫—Ä–æ–µ–º –∫–µ–π—Å –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –≤—ã–ø–∞–¥–µ—Ç!</p>
      <div id="case" class="case">–ö–µ–π—Å –∑–∞–∫—Ä—ã—Ç üîí</div>

      <button id="openBtn" class="btn">–û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å</button>
      <div class="row">
        <button id="shareBtn" class="btn" style="background:#58a6ff;color:#071422">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
        <button id="closeBtn" class="btn" style="background:#ff9f5a;color:#261306">–ó–∞–∫—Ä—ã—Ç—å</button>
      </div>

      <div id="result" class="result"></div>
      <div class="hint">–ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ –≤–Ω—É—Ç—Ä–∏ Telegram</div>
    </div>
  </div>

  <script>
    const tg = window.Telegram?.WebApp;
    tg?.ready();

    if (tg?.themeParams) {
      document.documentElement.style.setProperty('--bg', tg.themeParams.bg_color || '#0f1220');
      document.documentElement.style.setProperty('--text', tg.themeParams.text_color || '#ffffff');
      document.documentElement.style.setProperty('--card', tg.themeParams.secondary_bg_color || '#171a2a');
      document.documentElement.style.setProperty('--accent', tg.themeParams.button_color || '#57d2a3');
      document.documentElement.style.setProperty('--muted', tg.themeParams.hint_color || '#b9c0d0');
    }

    const prizes = [
      {title:'100 ‚≠ê –∑–≤—ë–∑–¥', rare:'–æ–±—ã—á–Ω—ã–π'},
      {title:'–°—Ç–∏–∫–µ—Ä–ø–∞–∫', rare:'–æ–±—ã—á–Ω—ã–π'},
      {title:'VIP-—Ä–æ–ª—å –Ω–∞ –¥–µ–Ω—å', rare:'—Ä–µ–¥–∫–∏–π'},
      {title:'–ü—Ä–æ–º–æ–∫–æ–¥ -50%', rare:'—Ä–µ–¥–∫–∏–π'},
      {title:'üéâ –°—É–ø–µ—Ä–ø—Ä–∏–∑: 500 ‚≠ê', rare:'–ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π'}
    ];

    const caseBox = document.getElementById('case');
    const openBtn = document.getElementById('openBtn');
    const closeBtn = document.getElementById('closeBtn');
    const shareBtn = document.getElementById('shareBtn');
    const resultEl = document.getElementById('result');

    function pickPrize(){
      const pool = [
        ...Array(40).fill(prizes[0]),
        ...Array(30).fill(prizes[1]),
        ...Array(20).fill(prizes[2]),
        ...Array(9).fill(prizes[3]),
        ...Array(1).fill(prizes[4]),
      ];
      return pool[Math.floor(Math.random()*pool.length)];
    }

    openBtn.onclick = async () => {
      caseBox.textContent = '–ö–µ–π—Å –∫—Ä—É—Ç–∏—Ç—Å—è‚Ä¶';
      caseBox.classList.add('spin');
      resultEl.style.display = 'none';

      await new Promise(r => setTimeout(r, 1200));
      caseBox.classList.remove('spin');

      const win = pickPrize();
      caseBox.textContent = '–ö–µ–π—Å –æ—Ç–∫—Ä—ã—Ç ‚úÖ';
      resultEl.innerHTML = `–í—ã–ø–∞–ª–æ: <b>${win.title}</b> <br><small>–†–µ–¥–∫–æ—Å—Ç—å: ${win.rare}</small>`;
      resultEl.style.display = 'block';

      try { tg?.sendData?.(JSON.stringify({type:'open_case', prize: win.title, rare: win.rare})); } catch(e) {}
      try { tg?.showPopup?.({title:'–ì–æ—Ç–æ–≤–æ', message:\`–í–∞—à –ø—Ä–∏–∑: ${win.title}\`, buttons:[{type:'ok'}]}); } catch(e) {}
    };

    closeBtn.onclick = () => {
      try { tg?.close(); } catch(e) { alert('–û–∫–Ω–æ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—ã–ª–æ –±—ã –∑–∞–∫—Ä—ã—Ç–æ –≤ Telegram.'); }
    };

    shareBtn.onclick = () => {
      try { tg?.shareUrl?.('https://t.me/'); } catch(e) { alert('–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –º–æ–∂–Ω–æ –∏–∑ Telegram.'); }
    };
  </script>
</body>
</html>
